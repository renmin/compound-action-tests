<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Test Template — Screenshot-Verifiable Harness</title>
  <link rel="stylesheet" href="common.css" />
</head>
<body>
  <div class="wrap">
    <div class="grid">
      <div class="left">
        <h1>Screenshot‑Verifiable Test Template</h1>
        <p class="muted">Use this template to build pages that validate remote mouse/keyboard actions and render machine‑readable results.</p>
        <div class="card">
          <h2>Run Meta</h2>
          <div class="kvs" id="meta">
            <div class="k">Test</div><div class="v" data-k="name">—</div>
            <div class="k">Run ID</div><div class="v" data-k="runId">—</div>
            <div class="k">Started</div><div class="v" data-k="startedAt">—</div>
            <div class="k">Actions</div><div class="v" data-k="actions">0</div>
            <div class="k">Pass</div><div class="v" data-k="pass">0</div>
            <div class="k">Fail</div><div class="v" data-k="fail">0</div>
          </div>
          <hr />
          <div class="toolbar">
            <button class="btn" id="btn-verify">Run Assertions</button>
          </div>
          <p class="muted" style="margin-top:6px">Recommended window size: <strong>1280×960</strong>.</p>
        </div>
        <div class="card">
          <div class="big-result" id="bigResult">WAITING</div>
          <div class="list" id="cases"></div>
          <h2 style="margin-top:12px">Logs</h2>
          <pre class="log" id="log"></pre>
        </div>
      </div>
      <div class="right">
        <div class="card">
          <h2>Validation Stage</h2>
          <div id="stage" class="stage">Place your test widgets here (targets, inputs, scroll containers, etc.)</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Fullscreen QR Overlay -->
  <div id="qrOverlay" class="qrovl" aria-hidden="true">
    <div id="qrBox" class="qrbox"></div>
    <div class="hint">QR code enlarged for reliable screenshot decoding. Click anywhere to close.</div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script src="common.js"></script>
  <script>
  ;(() => {
    const qs = new URLSearchParams(location.search);
    const testName = 'Unnamed Test';
    const testManager = new window.__TestCommon({
      testName,
      runId: qs.get('run'),
      startedAt: new Date().toISOString()
    });

    // 可在此注册断言，例如：
    // testManager.registerAssertion('assertion name', {key1: expected_value}, async () => ({key1: actual_value}));

  })()
  </script>
</body>
</html>
